(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2182a498"],{"1edc":function(e,t,r){},"4b65":function(e,t,r){"use strict";var i=r("c72a"),n=r.n(i);n.a},b848:function(e,t,r){"use strict";var i=r("1edc"),n=r.n(i);n.a},c72a:function(e,t,r){},d778:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.formRules}},[r("el-form-item",{attrs:{label:"内容",prop:"content"}},[r("el-input",{staticClass:"conten_input",attrs:{maxlength:"800",type:"textarea",autosize:{minRows:3},"show-word-limit":""},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),r("el-form-item",{attrs:{label:"文章分类",prop:"type_id"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.type_id,callback:function(t){e.$set(e.form,"type_id",t)},expression:"form.type_id"}},e._l(e.typeList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.type_name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"推荐等级",prop:"tuijian"}},[r("el-input",{attrs:{maxlength:"2","show-word-limit":"",placeholder:"100以内正整数，数字越大越可能上首页"},model:{value:e.form.tuijian,callback:function(t){e.$set(e.form,"tuijian",t)},expression:"form.tuijian"}})],1),r("el-form-item",{attrs:{label:"上传图片",prop:"pic"}},[r("el-upload",{ref:"upload",staticClass:"my-uploader",class:{hide:e.hideUploadEdit},attrs:{"list-type":"picture-card",action:"","auto-upload":!1,"on-change":e.uploaderImgs,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"file-list":e.form.pic,limit:9,accept:".jpg, .jpeg, .png, .gif, .bmp, .pdf, .JPG, .JPEG, .PBG, .GIF, .BMP, .PDF"}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),r("el-form-item",{attrs:{label:"上架"}},[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form.online,callback:function(t){e.$set(e.form,"online",t)},expression:"form.online"}})],1)],1),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.goBack}},[e._v("取 消")]),r("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)},n=[],a=(r("d3b7"),r("96cf"),{props:{type:String,info:Object},data:function(){var e=/^[1-9][0-9]*$/,t=function(t,r,i){if(!e.test(r)||r>99)return i(new Error("请填写100以内正整数!!"));i()};return{typeList:[],fullscreenLoading:!1,id:"",form:{type_id:"",content:"",pic:[],tuijian:null,online:!0},dialogImageUrl:"",dialogVisible:!1,disabled:!1,hideUploadEdit:!1,formRules:{type_id:[{required:!0,message:"请选择分类",trigger:"blur"}],content:[{required:!0,message:"请填写内容",trigger:"blur"}],tuijian:[{required:!0,validator:t,trigger:"blur"}]}}},created:function(){this.initTypeList()},methods:{initTypeList:function(){var e,t=this;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.$api.articleTypeFreeQuery(1,30).catch((function(e){return console.log(e),t.$message.error("数据获取失败"),""})));case 2:e=r.sent,this.typeList=e.data.list||[];case 4:case"end":return r.stop()}}),null,this)},uploaderImgs:function(e,t){var r,i,n,a;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(r=e.size/1024/1024<.5,i=500,console.log(r),r){s.next=6;break}return this.$message.error("上传文件大小不能超过 ".concat(i,"k!")),s.abrupt("return",!1);case 6:n=new FileReader,a=this,n.readAsDataURL(e.raw),n.onload=function(){var e;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(a.$api.uploadImgByBase64(n.result,"article_type").catch((function(e){return e})));case 2:e=r.sent,200==e.ret&&0==e.data.err_code?(a.form.pic.push({url:e.data.url,name:"article_type"}),a.hideUploadEdit=t.length>=9):a.$message({message:"图片上传失败,刷新或换图片！",type:"error"});case 4:case"end":return r.stop()}}))};case 10:case"end":return s.stop()}}),null,this)},handlePictureCardPreview:function(e){console.log(e),this.dialogImageUrl=e.url,this.dialogVisible=!0},handleRemove:function(e,t){this.form.pic=t,this.hideUploadEdit=t.length>=9},submitForm:function(){var e=this;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.$refs.form.validate((function(t){var r;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:if(!t){i.next=20;break}if(e.fullscreenLoading=!0,"change"!=e.type){i.next=8;break}return i.next=5,regeneratorRuntime.awrap(e.submitChange());case 5:r=i.sent,i.next=16;break;case 8:if("create"!=e.type){i.next=14;break}return i.next=11,regeneratorRuntime.awrap(e.submitCreate());case 11:r=i.sent,i.next=16;break;case 14:return e.$message({message:"操作失败！",type:"error"}),i.abrupt("return",!1);case 16:200==r.ret&&0==r.data.err_code?(e.$message({message:"操作成功!",type:"success"}),e.goBack()):"请登录后再操作"==r?e.$message({message:"请登录后再操作!",type:"warning"}):e.$message({message:"网络错误，操作失败！",type:"error"}),e.fullscreenLoading=!1,i.next=21;break;case 20:return i.abrupt("return",!1);case 21:case"end":return i.stop()}}))}));case 1:case"end":return t.stop()}}),null,this)},goBack:function(){this.$router.go(-1)},submitChange:function(){var e,t,r;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return e=JSON.stringify({pic:this.form.pic}),t=this.form.online?0:1,i.next=4,regeneratorRuntime.awrap(this.$api.articleChange(this.id,this.form.type_id,this.form.content,t,this.form.tuijian,e).catch((function(e){return e})));case 4:return r=i.sent,i.abrupt("return",r);case 6:case"end":return i.stop()}}),null,this)},submitCreate:function(){var e,t,r;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return e=JSON.stringify({pic:this.form.pic}),t=this.form.online?0:1,i.next=4,regeneratorRuntime.awrap(this.$api.createArticle(this.form.type_id,this.form.content,t,this.form.tuijian,e).catch((function(e){return e})));case 4:return r=i.sent,i.abrupt("return",r);case 6:case"end":return i.stop()}}),null,this)}},watch:{info:function(){var e,t=JSON.parse(this.info.litpic);t?(e=t.pic,console.log(e)):e=[],this.id=this.info.id,this.form={type_id:this.info.type_id,content:this.info.content,pic:e,tuijian:this.info.tuijian,online:0==this.info.online}},$router:function(){this.initTypeList()}}}),s=a,o=(r("4b65"),r("b848"),r("2877")),l=Object(o["a"])(s,i,n,!1,null,"1a0ca78a",null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-2182a498.fee384d0.js.map